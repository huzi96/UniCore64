From 42046b8d21b725a2438b3d54aab8603812bfa8fe Mon Sep 17 00:00:00 2001
From: LiangRongrong <Liangrongrong@mprc.pku.edu.cn>
Date: Wed, 30 Nov 2011 11:46:52 +0800
Subject: [PATCH 103/641] UniCore64: Modify some files which is related to asm
 memory.h

Signed-off-by: Liang Rongrong <liangrongrong@mprc.pku.edu.cn>
---
 arch/unicore64/include/asm/page.h   |    5 +++--
 arch/unicore64/kernel/vmlinux.lds.S |    4 ++--
 2 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/arch/unicore64/include/asm/page.h b/arch/unicore64/include/asm/page.h
index 9ae4251..90f88a0 100644
--- a/arch/unicore64/include/asm/page.h
+++ b/arch/unicore64/include/asm/page.h
@@ -1,9 +1,10 @@
 #ifndef __ASM_UNICORE64_PAGE_H__
 #define __ASM_UNICORE64_PAGE_H__
 
-#include <linux/const.h>
+#include <arch/hwdef-memory.h>
 
-#define PAGE_OFFSET		_AC(0xfffffff800000000, UL)
+/* Virtual start address of the first bank of RAM */
+#define PAGE_OFFSET		UC64_VM_KERNEL_START
 
 /* PAGE_SHIFT determines the page size */
 #define PAGE_SHIFT		(12)
diff --git a/arch/unicore64/kernel/vmlinux.lds.S b/arch/unicore64/kernel/vmlinux.lds.S
index 4b21400..cd95dec 100644
--- a/arch/unicore64/kernel/vmlinux.lds.S
+++ b/arch/unicore64/kernel/vmlinux.lds.S
@@ -1,8 +1,8 @@
 #include <asm-generic/vmlinux.lds.h>
 #include <asm/thread_info.h>
-#include <arch/memory.h>
 #include <asm/page.h>
 #include <asm/cache.h>
+#include <arch/hwdef-memory.h>
 
 OUTPUT_ARCH(unicore64)
 ENTRY(stext)
@@ -11,7 +11,7 @@ jiffies = jiffies_64;
 
 SECTIONS
 {
-	. = PAGE_OFFSET + KERNEL_IMAGE_START;
+	. = PAGE_OFFSET + UC64_PM_KIMAGE_START;
 
 	_text = .;
 	__init_begin = .;
-- 
1.7.9.5

