From 062877a9a1e7f9c6459a21d3149a598d6dcd68a8 Mon Sep 17 00:00:00 2001
From: GuanXuetao <gxt@mprc.pku.edu.cn>
Date: Sat, 10 Dec 2011 14:16:29 +0800
Subject: [PATCH 145/641] UniCore64: split pgtable-swap.h from asm/pgtable.h

Signed-off-by: GuanXuetao <gxt@mprc.pku.edu.cn>
---
 arch/unicore64/include/asm/pgtable-swap.h |   16 ++++++++++++++++
 arch/unicore64/include/asm/pgtable.h      |   15 +--------------
 2 files changed, 17 insertions(+), 14 deletions(-)
 create mode 100644 arch/unicore64/include/asm/pgtable-swap.h

diff --git a/arch/unicore64/include/asm/pgtable-swap.h b/arch/unicore64/include/asm/pgtable-swap.h
new file mode 100644
index 0000000..35a9dc3
--- /dev/null
+++ b/arch/unicore64/include/asm/pgtable-swap.h
@@ -0,0 +1,16 @@
+#ifndef __UNICORE64_ASM_PGTABLE_H__
+#error "This file is included ONLY in asm/pgtable.h"
+#endif
+
+#define PTE_FILE			PTE_YOUNG /* only when !PRESENT */
+#define PTE_FILE_MAX_BITS		36 /* FIXME */
+
+#define __swp_type(x)			({BUG(); 0; })
+#define __swp_offset(x)			({BUG(); 0; })
+#define __swp_entry(type, offset)	((swp_entry_t){0}) /* FIXME */
+#define __pte_to_swp_entry(pte)		((swp_entry_t) { pte_val(pte) })
+#define __swp_entry_to_pte(swp)		((pte_t) { (swp).val })
+
+#define pte_file(pte)			(pte_val(pte) & PTE_FILE)
+#define pte_to_pgoff(x)			({BUG(); 0; })
+#define pgoff_to_pte(x)			__pte({BUG(); 0; })
diff --git a/arch/unicore64/include/asm/pgtable.h b/arch/unicore64/include/asm/pgtable.h
index 2c19852..0a27784 100644
--- a/arch/unicore64/include/asm/pgtable.h
+++ b/arch/unicore64/include/asm/pgtable.h
@@ -2,14 +2,13 @@
 #define __UNICORE64_ASM_PGTABLE_H__
 
 #include <asm/pgtable-prot.h>
+#include <asm/pgtable-swap.h>
 
 #include <arch/hwdef-pgtable.h>
 #include <arch/hwdef-memory.h>
 
 #include <asm-generic/pgtable-nopud.h>
 
-#define PTE_FILE		PTE_YOUNG	/* only when !PRESENT */
-
 #define VMALLOC_START		UC64_VM_VMALLOC_START
 #define VMALLOC_END		UC64_VM_VMALLOC_END
 
@@ -99,18 +98,6 @@ extern void set_pte(pte_t *ptep, pte_t pteval);
 #define pmd_ERROR(pmd)			pr_err("%s:%d: bad pmd %016lx.\n", \
 					__FILE__, __LINE__, pmd_val(pmd))
 
-#define __swp_type(x)			({BUG(); 0; })
-#define __swp_offset(x)			({BUG(); 0; })
-#define __swp_entry(type, offset)	((swp_entry_t){0}) /* FIXME */
-#define __pte_to_swp_entry(pte)		((swp_entry_t) { pte_val(pte) })
-#define __swp_entry_to_pte(swp)		((pte_t) { (swp).val })
-
-#define pte_file(pte)			(pte_val(pte) & PTE_FILE)
-#define pte_to_pgoff(x)			({BUG(); 0; })
-#define pgoff_to_pte(x)			__pte({BUG(); 0; })
-
-#define PTE_FILE_MAX_BITS		36 /* FIXME */
-
 #include <asm-generic/pgtable.h>
 
 #endif /* __UNICORE64_ASM_PGTABLE_H__ */
-- 
1.7.9.5

