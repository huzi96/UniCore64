From a8c9b1050f5288384a5267f548bb4eb616829fee Mon Sep 17 00:00:00 2001
From: Guan Xuetao <gxt@mprc.pku.edu.cn>
Date: Tue, 13 Dec 2011 11:58:38 +0800
Subject: [PATCH 163/641] UniCore64: make arch-specific memchr, memcpy,
 memmove and memset available

Signed-off-by: Guan Xuetao <gxt@mprc.pku.edu.cn>
---
 arch/unicore64/include/asm/Kbuild   |    1 -
 arch/unicore64/include/asm/string.h |   16 ++++++++++++++++
 arch/unicore64/lib/Makefile         |    2 +-
 3 files changed, 17 insertions(+), 2 deletions(-)
 create mode 100644 arch/unicore64/include/asm/string.h

diff --git a/arch/unicore64/include/asm/Kbuild b/arch/unicore64/include/asm/Kbuild
index 2413b59..08d8206 100644
--- a/arch/unicore64/include/asm/Kbuild
+++ b/arch/unicore64/include/asm/Kbuild
@@ -51,7 +51,6 @@ generic-y += socket.h
 generic-y += sockios.h
 generic-y += stat.h
 generic-y += statfs.h
-generic-y += string.h
 generic-y += swab.h
 generic-y += system.h
 generic-y += termbits.h
diff --git a/arch/unicore64/include/asm/string.h b/arch/unicore64/include/asm/string.h
new file mode 100644
index 0000000..6604755
--- /dev/null
+++ b/arch/unicore64/include/asm/string.h
@@ -0,0 +1,16 @@
+#ifndef __UNICORE64_ASM_STRING_H__
+#define __UNICORE64_ASM_STRING_H__
+
+#define __HAVE_ARCH_MEMCPY
+extern void *memcpy(void *, const void *, __kernel_size_t);
+
+#define __HAVE_ARCH_MEMMOVE
+extern void *memmove(void *, const void *, __kernel_size_t);
+
+#define __HAVE_ARCH_MEMCHR
+extern void *memchr(const void *, int, __kernel_size_t);
+
+#define __HAVE_ARCH_MEMSET
+extern void *memset(void *, int, __kernel_size_t);
+
+#endif /* __UNICORE64_ASM_STRING_H__ */
diff --git a/arch/unicore64/lib/Makefile b/arch/unicore64/lib/Makefile
index 7f87ff1..ddab932 100644
--- a/arch/unicore64/lib/Makefile
+++ b/arch/unicore64/lib/Makefile
@@ -1,7 +1,7 @@
 lib-y			:= delay.o
 
 GNU_LIBC_A		:= $(shell $(CC) $(KBUILD_CFLAGS) -print-file-name=libc.a)
-GNU_LIBC_A_OBJS		:= memcpy.o memset.o wordcopy.o
+GNU_LIBC_A_OBJS		:= memchr.o memcpy.o memmove.o memset.o wordcopy.o
 lib-y			+= $(GNU_LIBC_A_OBJS)
 $(addprefix $(obj)/, $(GNU_LIBC_A_OBJS)):
 	$(Q)$(AR) p $(GNU_LIBC_A) $(notdir $@) > $@
-- 
1.7.9.5

