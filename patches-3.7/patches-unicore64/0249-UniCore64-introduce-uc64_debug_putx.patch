From 1cbf44772bd7549fcbbdef0ebd46bf97780af424 Mon Sep 17 00:00:00 2001
From: Guan Xuetao <gxt@mprc.pku.edu.cn>
Date: Wed, 18 Jan 2012 15:39:05 +0800
Subject: [PATCH 249/641] UniCore64: introduce uc64_debug_putx

Signed-off-by: Guan Xuetao <gxt@mprc.pku.edu.cn>
---
 arch/unicore64/include/arch/asm-debug.h |    4 +---
 arch/unicore64/lib/debug.S              |   13 +++++++++++++
 2 files changed, 14 insertions(+), 3 deletions(-)

diff --git a/arch/unicore64/include/arch/asm-debug.h b/arch/unicore64/include/arch/asm-debug.h
index fd97700..17ecfb0 100644
--- a/arch/unicore64/include/arch/asm-debug.h
+++ b/arch/unicore64/include/arch/asm-debug.h
@@ -25,9 +25,6 @@ __ASMMACRO_WRAP(.macro	uc64_debug_putdata, rdata, rt1, rt2;
 			mov	r0, #0;
 			mov	r1, &rdata;
 			bkpt;
-			mov	r0, #1;
-			mov	r1, #0x20;
-			bkpt;
 			mov	r0, &rt1;
 			mov	r1, &rt2;
 		.endm)
@@ -40,6 +37,7 @@ __ASMMACRO_WRAP(.macro	uc64_debug_putchar, rchar, rt1, rt2;
 
 #ifndef __ASSEMBLY__
 extern void uc64_debug_puts(const char *s);
+extern void uc64_debug_putx(unsigned long x);
 #endif /* __ASSEMBLY__ */
 
 #endif /* __UNICORE64_ARCH_ASM_DEBUG_H__ */
diff --git a/arch/unicore64/lib/debug.S b/arch/unicore64/lib/debug.S
index 91fa074..14e68d7 100644
--- a/arch/unicore64/lib/debug.S
+++ b/arch/unicore64/lib/debug.S
@@ -30,3 +30,16 @@ ENTRY(uc64_debug_puts)
 1004:
 	.asciz	"\nWarning: String is too long in uc64_debug_puts.\n"
 ENDPROC(uc64_debug_puts)
+
+/**
+ * uc64_debug_putx - print a data in hex format
+ * r0: the data to be printed
+ */
+ENTRY(uc64_debug_putx)
+	uc64_debug_putdata	r0, r14, r15
+
+	mov	r0, #0x20
+	uc64_debug_putchar	r0, r14, r15
+
+	return
+ENDPROC(uc64_debug_putx)
-- 
1.7.9.5

