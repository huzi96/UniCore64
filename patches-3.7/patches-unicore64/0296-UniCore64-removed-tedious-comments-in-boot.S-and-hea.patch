From 2ac062768061210da18816b4ac426b3d1b68e09f Mon Sep 17 00:00:00 2001
From: Guan Xuetao <gxt@mprc.pku.edu.cn>
Date: Fri, 3 Feb 2012 09:23:41 +0800
Subject: [PATCH 296/641] UniCore64: removed tedious comments in boot.S and
 head.S

Signed-off-by: Guan Xuetao <gxt@mprc.pku.edu.cn>
---
 arch/unicore64/boot/boot.S   |   27 ++-------------------------
 arch/unicore64/kernel/head.S |    6 ++----
 2 files changed, 4 insertions(+), 29 deletions(-)

diff --git a/arch/unicore64/boot/boot.S b/arch/unicore64/boot/boot.S
index ab870b2..668d66f 100644
--- a/arch/unicore64/boot/boot.S
+++ b/arch/unicore64/boot/boot.S
@@ -7,24 +7,11 @@
 	.section ".start"
 	.globl	_start
 _start:
-	/*
-	 * Initialize ASR and coprocessor 0.
-	 */
 	__head_initialize	r0
-
-	/*
-	 * Initialize dcache and icache.
-	 */
 	__cache_initialize	r0
 
-	/*
-	 * Set the sp register.
-	 */
 	dmovl	sp, #UC64_PM_ZIMAGE_STACKTOP
 
-	/*
-	 * Clear BSS region.
-	 */
 	__head_clear_bss
 
 #ifdef CONFIG_ARCH_FPGA
@@ -37,21 +24,11 @@ _start:
 	call	memcpy
 #endif /* CONFIG_ARCH_FPGA */
 
-	/*
-	 * Call decompress_kernel, and it's three parameters are:
-	 *   r0: output_start
-	 */
 	dmovl	r0, #UC64_PM_KIMAGE_START
 	call	decompress_kernel
 
-	/*
-	 * Flush the cache to maintain consistency.
-	 */
-	__flush_dcache	r0
-
-	/*
-	 * Initialize ASR and coprocessor 0.
-	 */
+	/* Re-initialize to system default status */
+	__flush_dcache		r0
 	__head_initialize	r0
 
 	/*
diff --git a/arch/unicore64/kernel/head.S b/arch/unicore64/kernel/head.S
index f8aab3f..c5cdff2 100644
--- a/arch/unicore64/kernel/head.S
+++ b/arch/unicore64/kernel/head.S
@@ -30,18 +30,16 @@
 	__HEAD
 ENTRY(stext)
 	__head_initialize	r0
-
 	__cache_initialize	r0
 
-	/* Set sp for function discipline */
 	ldd	sp, __priv_sp
 
-	call	__head_pgtable_init
-
 	/*
 	 * Enable the MMU.  This completely changes the structure of the visible
 	 * memory space.  You will not be able to trace execution through this.
 	 */
+	call	__head_pgtable_init
+
 	__invalid_tlb		r0
 
 	movc	r0, CP0_CTRLREG, #0
-- 
1.7.9.5

