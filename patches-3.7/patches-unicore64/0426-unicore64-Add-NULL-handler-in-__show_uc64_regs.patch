From d999417d4a52466c3da89ad6f011b4c8bcf0b526 Mon Sep 17 00:00:00 2001
From: Guan Xuetao <gxt@mprc.pku.edu.cn>
Date: Fri, 7 Sep 2012 14:54:58 +0800
Subject: [PATCH 426/641] unicore64: Add NULL-handler in __show_uc64_regs

Signed-off-by: Guan Xuetao <gxt@mprc.pku.edu.cn>
---
 arch/unicore64/kernel/showinfo.c |    8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)

diff --git a/arch/unicore64/kernel/showinfo.c b/arch/unicore64/kernel/showinfo.c
index a5eb5a3..d3c0f33 100644
--- a/arch/unicore64/kernel/showinfo.c
+++ b/arch/unicore64/kernel/showinfo.c
@@ -13,12 +13,10 @@ void __show_uc64_regs(struct pt_regs *regs)
 {
 	int i;
 
-	if (regs == NULL) {
-		pr_info("None Regs information.\n");
-		return;
-	}
+	if (regs == NULL)
+		regs = task_pt_regs(current_thread_info()->task);
 
-	pr_info("\nUniCore64 Regs Information:\n");
+	pr_info("\nUniCore64 pt_regs at %lx:\n", (unsigned long)regs);
 	pr_info(" ASR(value %lx):", regs->UC64_ASR);
 	pr_cont(" %s Mode,",
 			(regs->UC64_ASR & ASR_MODE_DEBUG) ? "DEBUG" :
-- 
1.7.9.5

