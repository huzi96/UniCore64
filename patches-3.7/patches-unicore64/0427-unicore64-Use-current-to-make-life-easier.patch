From a53de1f5f615ecf0e9f72a8a6c843f99cda25e83 Mon Sep 17 00:00:00 2001
From: Guan Xuetao <gxt@mprc.pku.edu.cn>
Date: Fri, 7 Sep 2012 15:00:08 +0800
Subject: [PATCH 427/641] unicore64: Use current to make life easier

Signed-off-by: Guan Xuetao <gxt@mprc.pku.edu.cn>
---
 arch/unicore64/kernel/process.c  |    2 +-
 arch/unicore64/kernel/showinfo.c |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/unicore64/kernel/process.c b/arch/unicore64/kernel/process.c
index 14e2878..a8029c5 100644
--- a/arch/unicore64/kernel/process.c
+++ b/arch/unicore64/kernel/process.c
@@ -12,7 +12,7 @@
 int kernel_execve(const char *filename, const char *const argv[],
 		const char *const envp[])
 {
-	struct pt_regs *regs = task_pt_regs(current_thread_info()->task);
+	struct pt_regs *regs = task_pt_regs(current);
 	int ret = do_execve(filename, argv, envp, regs);
 
 	if (ret < 0)
diff --git a/arch/unicore64/kernel/showinfo.c b/arch/unicore64/kernel/showinfo.c
index d3c0f33..68a70ce 100644
--- a/arch/unicore64/kernel/showinfo.c
+++ b/arch/unicore64/kernel/showinfo.c
@@ -14,7 +14,7 @@ void __show_uc64_regs(struct pt_regs *regs)
 	int i;
 
 	if (regs == NULL)
-		regs = task_pt_regs(current_thread_info()->task);
+		regs = task_pt_regs(current);
 
 	pr_info("\nUniCore64 pt_regs at %lx:\n", (unsigned long)regs);
 	pr_info(" ASR(value %lx):", regs->UC64_ASR);
-- 
1.7.9.5

