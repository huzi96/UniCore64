From cdb06f5214f95fb5c9c22c898342c752e890d360 Mon Sep 17 00:00:00 2001
From: Guan Xuetao <gxt@mprc.pku.edu.cn>
Date: Fri, 26 Oct 2012 15:54:08 +0800
Subject: [PATCH 443/641] unicore64: Add pte_alloc_one

Signed-off-by: Guan Xuetao <gxt@mprc.pku.edu.cn>
---
 arch/unicore64/mm/pgtable.c |    8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/arch/unicore64/mm/pgtable.c b/arch/unicore64/mm/pgtable.c
index 78d93d2..081052e 100644
--- a/arch/unicore64/mm/pgtable.c
+++ b/arch/unicore64/mm/pgtable.c
@@ -66,8 +66,12 @@ void pte_free_kernel(struct mm_struct *mm, pte_t *p)
  */
 pgtable_t pte_alloc_one(struct mm_struct *mm, unsigned long address)
 {
-	/* FIXME */
-	BUG();
+	struct page *pte = alloc_page(GFP_KERNEL);
+
+	if (pte)
+		pgtable_page_ctor(pte);
+
+	return pte;
 }
 
 /**
-- 
1.7.9.5

