From 8d57459263a3bd1beae041a973898a5dd70fea52 Mon Sep 17 00:00:00 2001
From: Qin Rui <qinrui@mprc.pku.edu.cn>
Date: Thu, 13 Sep 2012 10:54:32 +0800
Subject: [PATCH 453/641] UniCore64: Add syscall support

Signed-off-by: Qin Rui <qinrui@mprc.pku.edu.cn>
Signed-off-by: Liu Guoli <liuguoli@mprc.pku.edu.cn>
---
 arch/unicore64/kernel/Makefile |    2 +-
 arch/unicore64/kernel/signal.c |   13 +++++++++++++
 arch/unicore64/kernel/sys.c    |   32 ++++++++++++++++++++++++++++++++
 3 files changed, 46 insertions(+), 1 deletion(-)
 create mode 100644 arch/unicore64/kernel/signal.c

diff --git a/arch/unicore64/kernel/Makefile b/arch/unicore64/kernel/Makefile
index eb95009..a43c64e 100644
--- a/arch/unicore64/kernel/Makefile
+++ b/arch/unicore64/kernel/Makefile
@@ -10,7 +10,7 @@ CFLAGS_REMOVE_time.o		:= -pg
 obj-y				:= head.o entry.o switch_to.o
 obj-y				+= irq.o
 obj-y				+= process.o ptrace.o
-obj-y				+= setup.o showinfo.o sys.o
+obj-y				+= setup.o showinfo.o signal.o sys.o
 obj-y				+= time.o traps.o
 
 obj-$(CONFIG_UNICORE64)		+= cpu-uc64.o
diff --git a/arch/unicore64/kernel/signal.c b/arch/unicore64/kernel/signal.c
new file mode 100644
index 0000000..03d5d9c
--- /dev/null
+++ b/arch/unicore64/kernel/signal.c
@@ -0,0 +1,13 @@
+#include <linux/syscalls.h>
+
+SYSCALL_DEFINE3(sigaltstack, const stack_t __user *, uss,
+		stack_t __user *, uoss,	struct pt_regs *, regs)
+{
+	BUG();
+}
+
+SYSCALL_DEFINE1(rt_sigreturn, struct pt_regs *, regs)
+{
+	BUG();
+}
+
diff --git a/arch/unicore64/kernel/sys.c b/arch/unicore64/kernel/sys.c
index ae7943c..322d7bb 100644
--- a/arch/unicore64/kernel/sys.c
+++ b/arch/unicore64/kernel/sys.c
@@ -1 +1,33 @@
 #include <linux/kernel.h>
+#include <linux/syscalls.h>
+#include <asm-generic/syscalls.h>
+
+SYSCALL_DEFINE5(clone, unsigned long, clone_flags, unsigned long, newsp,
+		void __user *, parent_tid, void __user *, child_tid,
+		struct pt_regs *, regs)
+{
+	BUG();
+}
+
+SYSCALL_DEFINE4(execve, const char __user *, filename,
+		const char __user *const __user *, argv,
+		const char __user *const __user *, envp,
+		struct pt_regs *, regs)
+{
+	BUG();
+}
+
+SYSCALL_DEFINE6(mmap, unsigned long, addr, unsigned long, len,
+		unsigned long, prot, unsigned long, flags,
+		unsigned long, fd, off_t, offset)
+{
+	BUG();
+}
+
+#undef __SYSCALL
+#define __SYSCALL(nr, call) [nr] = (call),
+
+void *sys_call_table[__NR_syscalls] = {
+	[0 ... __NR_syscalls-1] = sys_ni_syscall,
+#include <asm/unistd.h>
+};
-- 
1.7.9.5

