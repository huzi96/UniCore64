From bbf84effa42f4bb84f8b08cd4408df03d78add6f Mon Sep 17 00:00:00 2001
From: Guan Xuetao <gxt@mprc.pku.edu.cn>
Date: Mon, 31 Dec 2012 17:57:50 +0800
Subject: [PATCH 521/641] unicore64: Use and.a/cmpand.a to replace
 and+comsub.a

Signed-off-by: Guan Xuetao <gxt@mprc.pku.edu.cn>
---
 arch/unicore64/kernel/entry.S |    6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

diff --git a/arch/unicore64/kernel/entry.S b/arch/unicore64/kernel/entry.S
index 8804c054..d914708 100644
--- a/arch/unicore64/kernel/entry.S
+++ b/arch/unicore64/kernel/entry.S
@@ -120,12 +120,10 @@ ret_to_user:
 	__irq_disable
 	__thread_info	r17
 	ldw		r18, [r17+], #THREAD_INFO_FLAGS
-	and		r0, r18, #(1 << TIF_NEED_RESCHED)
-	cmpsub.a	r0, #0
+	cmpand.a	r18, #(1 << TIF_NEED_RESCHED)
 	adr		lr, ret_to_user
 	bne		schedule
-	and		r0, r18, #(1 << TIF_NOTIFY_RESUME | 1 << TIF_SIGPENDING)
-	cmpsub.a	r0, #0
+	and.a		r0, r18, #(1 << TIF_NOTIFY_RESUME | 1 << TIF_SIGPENDING)
 	dmov		r1, #0                  @ 'syscall'
 	bne.l		do_notify_resume
 	__thread_info	r17
-- 
1.7.9.5

