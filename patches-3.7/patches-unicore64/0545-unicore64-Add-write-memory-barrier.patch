From fe867eb8e3fd25f885997b2f11b429c02a4a3996 Mon Sep 17 00:00:00 2001
From: Chang Huaixin <changhuaixin@mprc.pku.edu.cn>
Date: Mon, 15 Apr 2013 15:05:32 +0800
Subject: [PATCH 545/641] unicore64: Add write memory barrier

Signed-off-by: Chang Huaixin <changhuaixin@mprc.pku.edu.cn>
---
 arch/unicore64/kernel/smp.c |    2 ++
 1 file changed, 2 insertions(+)

diff --git a/arch/unicore64/kernel/smp.c b/arch/unicore64/kernel/smp.c
index 94c97a6..8cfcf09 100644
--- a/arch/unicore64/kernel/smp.c
+++ b/arch/unicore64/kernel/smp.c
@@ -70,6 +70,8 @@ static int __init smp_boot_one_cpu(unsigned int cpu, struct task_struct *idle)
 
 	smp_secondary_alive = 0;
 
+	wmb();
+
 	/*
 	 * CSU is not quite ready. Use a temporary reg 0xff6100000.
 	 */
-- 
1.7.9.5

