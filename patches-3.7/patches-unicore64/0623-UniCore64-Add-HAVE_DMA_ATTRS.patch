From aed3cc185080f94140e365a8e8bdcb3e768c8fe7 Mon Sep 17 00:00:00 2001
From: Guan Xuetao <gxt@mprc.pku.edu.cn>
Date: Tue, 6 May 2014 00:07:58 +0800
Subject: [PATCH 623/641] UniCore64: Add HAVE_DMA_ATTRS

Signed-off-by: Guan Xuetao <gxt@mprc.pku.edu.cn>
---
 arch/unicore64/Kconfig                   |    1 +
 arch/unicore64/include/asm/dma-mapping.h |   11 +++++++++++
 2 files changed, 12 insertions(+)

diff --git a/arch/unicore64/Kconfig b/arch/unicore64/Kconfig
index 8eace9f..b89a05d 100644
--- a/arch/unicore64/Kconfig
+++ b/arch/unicore64/Kconfig
@@ -6,6 +6,7 @@ config UNICORE64
 	select HAVE_KERNEL_LZO
 	select HAVE_KERNEL_LZMA
 	select HAVE_MEMBLOCK
+	select HAVE_DMA_ATTRS
 	select ARCH_WANT_FRAME_POINTERS
 	select GENERIC_IRQ_SHOW
 	select GENERIC_KERNEL_THREAD
diff --git a/arch/unicore64/include/asm/dma-mapping.h b/arch/unicore64/include/asm/dma-mapping.h
index fb9cad7..948510d 100644
--- a/arch/unicore64/include/asm/dma-mapping.h
+++ b/arch/unicore64/include/asm/dma-mapping.h
@@ -1,6 +1,16 @@
 #ifndef __UNICORE64_ASM_DMA_MAPPING_H__
 #define __UNICORE64_ASM_DMA_MAPPING_H__
 
+#ifdef __KERNEL__
+
+#include <linux/mm_types.h>
+#include <linux/scatterlist.h>
+#include <linux/swiotlb.h>
+
+#include <asm-generic/dma-coherent.h>
+
+#include <asm/cacheflush.h>
+
 extern struct dma_map_ops swiotlb_dma_map_ops;
 
 #define get_dma_ops(dev)		(&swiotlb_dma_map_ops)
@@ -24,4 +34,5 @@ extern void dma_mark_clean(void *addr, size_t size);
 
 #include <asm-generic/dma-mapping-common.h>
 
+#endif /* __KERNEL__ */
 #endif /* __UNICORE64_ASM_DMA_MAPPING_H__ */
-- 
1.7.9.5

