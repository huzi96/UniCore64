From cb34c8415ec1c3972635ad0eba2ea33d7869e466 Mon Sep 17 00:00:00 2001
From: Guan Xuetao <gxt@mprc.pku.edu.cn>
Date: Thu, 29 May 2014 14:23:19 +0800
Subject: [PATCH 639/641] UniCore64: it's too slow to use flush_tlb_mm in
 update_mmu_cache

Signed-off-by: Guan Xuetao <gxt@mprc.pku.edu.cn>
---
 arch/unicore64/mm/mmu.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/arch/unicore64/mm/mmu.c b/arch/unicore64/mm/mmu.c
index ce48b05..b629d2e 100644
--- a/arch/unicore64/mm/mmu.c
+++ b/arch/unicore64/mm/mmu.c
@@ -108,6 +108,7 @@ void __init paging_init(void)
 void update_mmu_cache(struct vm_area_struct *vma, unsigned long addr,
 	pte_t *ptep)
 {
-	flush_tlb_mm(vma->vm_mm);
+	/* It's too slow to use flush_tlb_mm(vma->vm_mm) */
+	__invalid_tlb();
 	flush_cache_all();
 }
-- 
1.7.9.5

